#!/bin/sh

SNAPSHOT_TARGET_VOLUME(){
	SNAPSHOT_TARGET_VOLUME_COUNT=`SNAPSHOT_TARGET_VOLUME__COUNT`
	eval "SNAPSHOT_TARGET_VOLUME__NAME_${SNAPSHOT_TARGET_VOLUME_COUNT}=\"\${1}\""
	eval "SNAPSHOT_TARGET_VOLUME__MOUNTPOINT_${SNAPSHOT_TARGET_VOLUME_COUNT}=\"\${2}\""
}

SNAPSHOT_TARGET_VOLUME__GET_NAME(){
	eval "echo \${SNAPSHOT_TARGET_VOLUME__NAME_${1}}"
}

SNAPSHOT_TARGET_VOLUME__GET_MOUNTPOINT(){
	eval "echo \${SNAPSHOT_TARGET_VOLUME__MOUNTPOINT_${1}}"
}

SNAPSHOT_TARGET_VOLUME__COUNT(){
	COUNT=`set | grep "^SNAPSHOT_TARGET_VOLUME__NAME_[0-9]*=" | wc -l`
	echo ${COUNT}
}

SNAPSHOT_TARGET_VOLUME__LOOPEND(){
	COUNT=`SNAPSHOT_TARGET_VOLUME__COUNT`
	echo `expr ${COUNT} - 1`
}

SNAPSHOT_TARGET_WORLD(){
	COUNT=`SNAPSHOT_TARGET_WORLD__COUNT`
	eval "SNAPSHOT_TARGET_WORLD__NAME_${COUNT}=\"\${1}\""
	SNAPSHOT_TARGET_VOLUME "${WROLD_PUT_PEARENT_POOL__POOL_NAME}/${MINECRAFT_SERVER_SERVICE_NAME}_${1}" "${MINECRAFT_SERVER_ROOT}/${1}"
}

SNAPSHOT_TARGET_WORLD__GET_NAME(){
	eval "echo \${SNAPSHOT_TARGET_WORLD__NAME_${1}}"
}

SNAPSHOT_TARGET_WORLD__COUNT(){
	COUNT=`set | grep "^SNAPSHOT_TARGET_WORLD__NAME_[0-9]*=" | wc -l`
	echo ${COUNT}
}

SNAPSHOT_TARGET_WORLD__LOOPEND(){
	COUNT=`SNAPSHOT_TARGET_WORLD__COUNT`
	echo `expr ${COUNT} - 1`
}

WROLD_PUT_PEARENT_POOL(){
	WROLD_PUT_PEARENT_POOL__POOL_NAME="${1}"
	loopend=`SNAPSHOT_TARGET_WORLD__LOOPEND`
	
	if [ ${loopend} -ge 0 ] ; then
		
		for index in `seq 0 ${loopend}`; do
			
			name="${WROLD_PUT_PEARENT_POOL__POOL_NAME}/${MINECRAFT_SERVER_SERVICE_NAME}_${1}"
			mountpoint="${MINECRAFT_SERVER_ROOT}/${1}"
			eval "SNAPSHOT_TARGET_VOLUME__NAME_${SNAPSHOT_TARGET_VOLUME_COUNT}=\"\${name}\""
			eval "SNAPSHOT_TARGET_VOLUME__MOUNTPOINT_${SNAPSHOT_TARGET_VOLUME_COUNT}=\"\${mountpoint}\""
			
		done
		
	fi
	
}